id: migrate_recetas_update_nuevas_categorias
label: 'Migrate Recetas from the xml file'

source:
  plugin: url
  data_fetcher_plugin: file
  data_parser_plugin: simple_xml
  urls:
    - 'modules/custom/royal_migrate/sources/RECETAS.xml'
  # An xpath-like selector corresponding to the items to be imported.
  item_selector: /select_rmt_nombre_tipo_plato_r_from_rct_r_rct_m_tipoplato_rmt_where_r_id_platip_rmt_id_/DATA_RECORD
  constants:
    file_destination: 'public://images/recetas/'
  ids:
    field_old_id:
      type: string

  fields:

    -
      name: field_necesidades_especificas
      label: 'Common content'
      selector: necesidades
    -
      name: field_tipo_de_plato
      label: 'Tipo plato'
      selector: tipo_plato
    -
      name: field_tipo_de_dieta
      label: 'Tipo de preparacion'
      selector: perfil

#    !! @ToDo puede ser interesante manter la url original?
#    -
#      name: content
#      label: 'Common content'
#      selector: url_amigable

    -
      name: field_old_id
      label: 'Old id'
      selector: id

    -
      name: field_estacion
      label: 'Common content'
      selector: estacion


process:

  field_old_id:
    plugin: recetas_manage_recetas_update_nuevas_categorias
    source: field_old_id


destination:
  plugin: noop

